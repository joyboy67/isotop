#!/usr/local/bin/python3
# -*- coding: utf-8 -*-
#
#  qs
#  
#  Copyright 2016 3hg team <3hg@lists.toile-libre.org>
#  
# Licence : MIT

import sys
import webbrowser
if sys.version_info >= (3, 0):
    from tkinter import *
    from tkinter import ttk
    from tkinter import messagebox
else:
    from Tkinter import *
    import ttk

text_="""q     :      qwant
g     :      google
bee   :      framabee
d     :      duckduckgo
e     :      ecosia
y     :      youtube
"""
text2_="""
Le motif est facultatif
Appuyez sur <EntrÃ©e> pour valider
"""

engines={'q' :  'https://www.qwant.com/?q=',\
'd' : 'https://duckduckgo.com/?kh=1&kl=fr-fr&ks=m&kj=kt&ky=-1&kad=fr_FR&q=',\
'qbee' :'https://framabee.org/?q=',\
'e' : 'https://www.ecosia.org/search.php?q=',\
'g' : 'https://startpage.com/do/search?query=',\
'y' : 'http://www.youtube.com/results?search_query='\
}

default='d'

class MyWindow():

    def __init__(self):

        # main window
        self.root = Tk()

        # style
        #('clam', 'alt', 'default', 'classic')
        style = ttk.Style()
        style.theme_use("clam")
        style.configure('TNotebook', tabposition='n')

        self.root.title("Rechercher sur le web")

        mainframe = ttk.Frame(self.root)
        mainframe.pack(fill=BOTH,expand=True)

        label = Label(mainframe,text=text_, font=("monospace", 10), justify=LEFT)
        label.pack(expand=True, fill=BOTH)

        sep = ttk.Separator(mainframe)
        sep.pack()

        label = Label(mainframe,text=text2_, font=("monospace", 10), justify=LEFT)
        label.pack(expand=True, fill=BOTH)
        
        self.entry = ttk.Entry(mainframe)
        self.entry.pack(fill=X,expand=True)
        self.entry.bind("<Return>", self.search)
        self.entry.focus_set()


        try :
            c = self.root.clipboard_get().strip()
            if c:
                self.entry.delete(0, END)
                self.entry.insert(0, c)
        except:
            c= ""

        self.root.mainloop()

    def search(self, event):
        s = self.entry.get().strip()

        if len(s) > 0:
            e = s.split(' ',1)
            if e[0] in engines.keys():
                url="{0}{1}".format(engines[e[0]], e[1].replace(' ','+'))
            else:
                url="{0}{1}".format(engines[default], s.replace(' ','+'))
            webbrowser.open(url)
            self.root.destroy()


def main():
    win = MyWindow()
    return 0

if __name__ == '__main__':
	main()

